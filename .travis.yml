language: python

dist: xenial

sudo: false

matrix:
  include:
    - os: linux
      python: 2.7
    - os: linux
      python: 3.4
    - os: linux
      python: 3.5
    - os: linux
      python: 3.6
    - os: linux
      python: 3.7
    - os: osx
      language: generic
      env: PY_VER=2.7.15
    - os: osx
      language: generic
      env: PY_VER=3.4.9
    - os: osx
      language: generic
      env: PY_VER=3.5.6
    - os: osx
      language: generic
      env: PY_VER=3.6.8
    - os: osx
      language: generic
      env: PY_VER=3.7.2
    

addons:
  apt:
    packages:
    - ffmpeg

  homebrew:
    packages:
    - ffmpeg
    - libmagic
    update: true

before_install: |
  if [[ $TRAVIS_OS_NAME == 'osx' ]]; then
      brew update;
      brew install pyenv;
      eval "$(pyenv init -)";
      PYTHON_CONFIGURE_OPTS="--enable-shared" pyenv install $PY_VER;
      pyenv global $PY_VER;
  fi

install:
  - python setup.py install
  - pip install -U pytest coverage pytest-cov codecov python-magic

script:
  - python setup.py test

after_success:
  - codecov

